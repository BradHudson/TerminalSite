import {
  ConsentSetting,
  ProviderLibrary,
  ProvidersConfig,
  UserConsent,
  UserConsentCategories,
} from '@blotoutio/cdn/types'
import { UserKey, Data, Manifest } from './index'

type Navigator = {
  userAgent: string
}

type TagPayload = {
  eventName: string
  eventId: string
  timestamp: number
  providerData?: Partial<Record<ProviderLibrary, Record<string, Data>>>
  data?: Data
  providers?: ProvidersConfig | null | undefined
}

type ConsentPayload = {
  consentString: UserConsent | null
  consentCategories: UserConsentCategories
}

type UserPayload = {
  key: UserKey
  value: string
  providers?: ProvidersConfig | null | undefined
}

type DataPayload = {
  data: Record<string, string>
  providers?: ProvidersConfig | null | undefined
}

type PostPayload = {
  pageUrl: string
  pageTitle: string
  referrer: string
  search: string
  locale: string
  sdkVersion: string
  userAgent: string
  data?: Data
  storage?: Data
}

type InitResponse = {
  result: Manifest[]
  userId?: string
  storageId?: number
  consent: UserConsent
  consentCategories: UserConsentCategories
  consentSetting: ConsentSetting
  isNewUser?: boolean
  session: {
    isNewSession: boolean
    sessionId: string | undefined
  }
  currency?: {
    providers: string[]
    rates: { from: string; to: string; value: number }[]
  }
  skipZeroPurchaseEvent?: boolean
  geoCountry: string | null
  geoRegion: string | null
  isEURequest: boolean
}
